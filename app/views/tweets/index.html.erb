<%
   require 'json'
   search_query = params[:search] ? params[:search] : ""
   result_limit = params[:result_limit] ? params[:result_limit] : 10
   starting_point = params[:starting_point] ? params[:starting_point] : 0
   results = @tweets.where(text: /#{Regexp.escape(search_query)}/i).skip(starting_point).limit(result_limit)
   total_results = results.length
   result_count = results.count(true)
   last_record_number = starting_point.to_i + result_count
   response_object = {query: search_query, result_count: result_count, results: results, last_record_number: last_record_number, total_results: total_results}
%>
<%= response_object.to_json.html_safe %>